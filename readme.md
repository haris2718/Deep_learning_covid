# 🧠 Ανάλυση Ακτινογραφιών για Διάγνωση COVID-19 με Χρήση Βαθιάς Μάθησης

## 🔬 Εισαγωγή

Το παρόν έργο εστιάζει στην **ανάλυση ακτινογραφιών θώρακα** με στόχο την **ταξινόμησή τους σε τρεις διακριτές κατηγορίες**: υγιείς ασθενείς, ασθενείς με COVID-19 και ασθενείς με κοινή πνευμονία. Για την υλοποίηση αυτής της πρόκλησης χρησιμοποιήθηκε η μεθοδολογία της **βαθιάς μάθησης (Deep Learning)**, με βασικό εργαλείο τη βιβλιοθήκη **TensorFlow/Keras**, και συγκεκριμένα ένα **συνελικτικό νευρωνικό δίκτυο (CNN)** βασισμένο στην αρχιτεκτονική VGG16. Η βαθιά μάθηση επιτρέπει στο μοντέλο να **εξάγει αυτόματα χαρακτηριστικά από τις εικόνες**, χωρίς την ανάγκη για χειροκίνητη επιλογή, κάτι που είναι ιδιαίτερα χρήσιμο στην ιατρική απεικόνιση.

Η **διαδικασία εκπαίδευσης** περιλαμβάνει αρκετά βήματα: αρχικά πραγματοποιείται **προεπεξεργασία των εικόνων** με κανονικοποίηση τιμών pixel και **αύξηση δεδομένων (data augmentation)**, η οποία βοηθά στη δημιουργία ποικιλίας δεδομένων από περιορισμένο πλήθος αρχικών εικόνων. Τεχνικές όπως περιστροφή, μετατόπιση και zoom εφαρμοστήκαν για να ενισχύσουν τη γενίκευση του μοντέλου και να περιορίσουν το **φαινόμενο της υπερεκπαίδευσης (overfitting)** — δηλαδή το να "θυμάται" το μοντέλο υπερβολικά καλά τα δεδομένα εκπαίδευσης εις βάρος της απόδοσής του σε νέα, άγνωστα δεδομένα.

Κατά την εκπαίδευση, εφαρμόστηκαν **dropout layers** (τυχαία απενεργοποίηση νευρώνων), μεταβολή του **ρυθμού μάθησης (learning rate scheduling)** και χρήση **προ-εκπαιδευμένων βαρών** από το ImageNet (transfer learning), ώστε να επιτευχθεί ταχύτερη σύγκλιση και καλύτερη γενίκευση. Επιπλέον, χρησιμοποιήθηκαν callbacks όπως το `ModelCheckpoint` και `ReduceLROnPlateau` για την αποθήκευση των καλύτερων μοντέλων και την αυτόματη ρύθμιση του ρυθμού μάθησης αντίστοιχα. Η αξιολόγηση έγινε με βάση τις μετρικές **accuracy**, **loss**, και **val_accuracy**, με την πρόοδο να καταγράφεται και να οπτικοποιείται γραφικά.

Τέλος, το μοντέλο έχει τη δυνατότητα να αποθηκεύει τις βέλτιστες παραμέτρους του σε μορφή **CSV**, ενώ υποστηρίζει **εύκολη παραμετροποίηση** μέσω μεταβλητών όπως ο ρυθμός μάθησης, το batch size, και η διάρκεια εκπαίδευσης (epochs). Μέσω αυτής της προσέγγισης, καθίσταται δυνατή η δημιουργία ενός εργαλείου που μπορεί δυνητικά να συνεισφέρει στην **αυτόματη διάγνωση** και στην **υποβοήθηση του ιατρικού προσωπικού**, ειδικά σε περιόδους πίεσης όπως η πανδημία COVID-19.

## 📌  Συνοπτική περιγραφή του project

Αυτό το υποσύστημα αποτελεί μέρος ενός ολοκληρωμένου έργου βαθιάς μάθησης με στόχο τη **διάγνωση ασθενειών από ακτινογραφίες θώρακα**. Το μοντέλο που αναπτύσσεται ταξινομεί τις ακτινογραφίες σε τρεις κατηγορίες:

- ✅ Υγιής (Healthy)
- 🦠 Ασθενής με COVID-19
- 🌫️ Ασθενής με κοινή πνευμονία

Χρησιμοποιεί σύγχρονες τεχνικές της τεχνητής νοημοσύνης και βασίζεται σε προ-εκπαιδευμένα μοντέλα όπως το **VGG16**.

---

## 🚀 Τεχνολογίες

- **Python**
- **TensorFlow & Keras** (deep learning)
- **OpenCV** (επεξεργασία εικόνας)
- **Pandas & NumPy** (χειρισμός δεδομένων)
- **Matplotlib** (οπτικοποίηση)
- **Google Colab / Google Drive** – Εκτέλεση και αποθήκευση


---

## ⚙️ Λειτουργίες

### 1. Προεπεξεργασία Δεδομένων

- **Κανονικοποίηση** των εικόνων (rescaling σε [0,1]).
- **Data Augmentation** με χρήση `ImageDataGenerator`:
  - Περιστροφή, μετατοπίσεις, ζουμ, shear.
  - Μείωση overfitting με αλλαγές στις εικόνες.
- Διαχωρισμός των δεδομένων σε **training** και **validation set** με ισορροπημένες κατηγορίες.


### 2. Δημιουργία Μοντέλου

- Βασισμένο στο **VGG16** με βάρη από ImageNet (`include_top=False`).
- Τα αρχικά layers του μοντέλου **παγώνουν** για να διατηρηθούν οι προκαθορισμένες γνώσεις.
- Προστίθενται πλήρως συνδεδεμένα layers (Dense) και dropout για αποφυγή overfitting.
- Τελικό layer με **softmax** για τριπλή κατηγοριοποίηση.

### 3. Εκπαίδευση & Αξιολόγηση

- Ορισμός batch size, αριθμού εποχών, validation split
- Υποστήριξη **συνέχισης εκπαίδευσης** από προϋπάρχον μοντέλο (`load_weights`)
- Χρήση callbacks όπως `ModelCheckpoint`, `ReduceLROnPlateau`
   - ModelCheckpoint: Αποθήκευση του καλύτερου μοντέλου με βάση τη val_accuracy.
   - ReduceLROnPlateau: Αυτόματη μείωση learning rate αν δεν βελτιώνεται η απόδοση.
   - LearningRateScheduler: Σταδιακή αλλαγή του learning rate.
   - Custom Monitoring Callback: Εκτύπωση πληροφοριών ανά εποχή, χρόνος εκτέλεσης και διαφορά val_acc - acc.
- Ρύθμιση Learning Rate Scheduling με συνάρτηση lr_schedule (μείωση του ρυθμού όσο αυξάνονται οι εποχές εκπαίδευσης)
- Υπολογισμός accuracy, precision, recall 

### 4. Αποθήκευση & Αναφορά

- Αποθήκευση εκπαιδευμένων μοντέλων σε φάκελο `saved_models_VGG16validation`
- Οπτικοποίηση αποτελεσμάτων με διαγράμματα
   - Γραφήματα Loss vs Val Loss
     
     <p align="left">
      <img src="https://github.com/haris2718/Deep_learning_covid/blob/main/assets/Loss.png" width="25%" hspace="10" />  
     </p>
     
   - Γραφήματα Accuracy vs Val Accuracy
     <p align="left">
      <img src="https://github.com/haris2718/Deep_learning_covid/blob/main/assets/Accuracy.png" width="25%" hspace="10" />  
     </p>
- Αποθήκευση αποτελεσμάτων σε `.csv`

---

## 📁 Δομή Δεδομένων

```bash
project/
├── extracted_files/
│   ├── train_images/              # Εικόνες εκπαίδευσης
│   ├── labels_train.csv           # Ετικέτες για το train set
│   └── saved_models_VGG16validation/
│       └── <αποθηκευμένα_μοντέλα>.h5


